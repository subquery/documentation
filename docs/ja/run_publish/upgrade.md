# SubQuery プロジェクトの新しいバージョンをデプロイする

## ガイドライン

SubQuery プロジェクトは、常に新しいバージョンをアップグレードしてデプロイする自由がありますが、SubQuery プロジェクトが世界に公開されている場合は、このプロセスの間に配慮してください。 注意すべきいくつかの重要なポイント:

- アップグレードが破損した変更である場合、新しいプロジェクトを作成するか（例：`My SubQuery Project V2`）、ソーシャルメディアチャンネルを通じてコミュニティに変更の警告を十分に行ってください。
- 新しい SubQuery プロジェクトのバージョンをデプロイすると、新しいバージョンが生成ブロックから完全なチェーンのインデックスを作成するため、ダウンタイムが発生します。

## 変更をデプロイする

SubQuery Project にログインし、新しいバージョンをデプロイするプロジェクトを選択します。 本番またはステージングスロットにデプロイするかを選択できます。 この 2 つのスロットは分離された環境で、それぞれ独自のデータベースを持ち、独立して同期をとっています。

ステージングスロットへのデプロイは、最終的なステージングテストやプロジェクトデータの再同期が必要な場合のみ行うことをお勧めします。 その後、ダウンタイムなしで本番環境に昇格させることができます。 [課題をより簡単にデバッグ](../academy/tutorials_examples/debug-projects.md)できるので、 [ローカルでプロジェクトを実行](../run_publish/run.md)するとテストが速くなります。

ステージングスロットは以下の場合に最適です：

- SubQuery Project の変更を別環境で最終検証します。 ステージングスロットは、dApps で使用できる本番環境とは異なる URL を持っています。
- 更新された SubQuery プロジェクトのデータのウォームアップとインデックス作成により、dApp のダウンタイムをなくすことができます
- 公開せずに、SubQuery プロジェクトの新しいリリースを準備します。 ステージングスロットはエクスプローラでは公開されず、あなただけに表示される固有の URL を持っています。

![ステージングスロット](/assets/img/staging_slot.png)

#### 最新のインデクサとクエリサービスにアップグレードする

もし、最新のインデクサ ([`@subql/node`](https://www.npmjs.com/package/@subql/node)) やクエリーサービス ([`@subql/query`](https://www.npmjs.com/package/@subql/query)) にアップグレードして定期的にパフォーマンスと安定性を改善したいだけなら、新しいバージョンのパッケージを選択して保存するだけでよいのです。 これはわずか数分間のダウンタイムを引き起こします。

#### SubQuery プロジェクトの新しいバージョンをデプロイする

デプロイしたい SubQuery プロジェクトのコードベースのバージョンの GitHub からコミットハッシュ（完全なコミットハッシュをコピー）を記入する。 これは現在のチェーンをインデックスするのにかかる時間に応じて、より長いダウンタイムを引き起こします。 いつでもここで進捗状況を確認することができます.

## 次のステップ - プロジェクトに接続

デプロイが正常に完了し、ノードがチェーンからデータのインデックスを作成したら、表示された GraphQL クエリエンドポイントからプロジェクトに接続することができるようになります。

![プロジェクトを展開および同期する](/assets/img/projects-deploy-sync.png)

または、プロジェクトのタイトルの横にある 3 つの点をクリックして、SubQuery Explorer で表示することもできます。 ブラウザ内のプレイグラウンドを使用して始めることができます - [Explorer の使い方についてはこちら](../run_publish/query.md) をご覧ください。
