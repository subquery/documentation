# Агрегатные функции

## Группировка

SubQuery поддерживает расширенные агрегатные функции, позволяющие выполнять вычисления для набора значений во время запроса.

Агрегатные функции обычно используются вместе с функцией GroupBy в запросе.

GroupBy позволяет быстро получить различные значения в наборе от SubQuery в одном запросе.

![Graphql Groupby](/assets/img/graphql_aggregation.png)

## Расширенные агрегатные функции

SubQuery предоставляет следующие агрегатные функции в небезопасном режиме:

- ` sum ` (применяется к полям, подобным числам) - результат сложения всех значений вместе
- `distinctCount` (применяется ко всем полям) - подсчет количества отдельных значений
- `min` (применяется к полям, подобным числам) - наименьшее значение
- `max` (применяется к полям, подобным числам) - наибольшее значение
- ` average ` (применяется к полям типа числа) - среднее (среднеарифметическое) значение
- `stddevSample` (применяется к полям, подобным числам) - выборочное стандартное отклонение значений
- `stddevPopulation` (применяется к полям, подобным числам) - популяционное стандартное отклонение значений
- `varianceSample` (применяется к полям, подобным числам) - выборочная дисперсия значений
- `variancePopulation` (применяется к полям, подобным числам) - дисперсия популяции значений

Реализация агрегатных функций в SubQuery основана на [pg-aggregates](https://github.com/graphile/pg-aggregates), более подробную информацию вы можете найти там

**Обратите внимание, что для использования этих функций необходимо включить флаг `--unsafe` в службе запросов. [Read more](./references.md#unsafe-2). Обратите внимание, что команда `--unsafe` не позволит запустить ваш проект в сети SubQuery, и вы должны обратиться в службу поддержки, если хотите, чтобы эта команда была запущена с вашим проектом в управляемой службе SubQuery ([project.subquery.network](https://project.subquery.network)).**
